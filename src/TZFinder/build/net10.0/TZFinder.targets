<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup>
    
    <TimeZoneData Condition="'$(TimeZoneData)' == ''">Medium</TimeZoneData>
    <TimeZoneDataDirectory Condition="'$(TimeZoneDataDirectory)' != '' and !HasTrailingSlash('$(OutputPath)')">$(TimeZoneDataDirectory)\</TimeZoneDataDirectory>
    
    <_TimeZoneDataFile Condition="'$(TimeZoneData)' == 'Small'">20_5000_NoEtc_TimeZoneData.bin</_TimeZoneDataFile>
    <_TimeZoneDataFile Condition="'$(TimeZoneData)' == 'Medium'">25_600_NoEtc_TimeZoneData.bin</_TimeZoneDataFile>
    <_TimeZoneDataFile Condition="'$(TimeZoneData)' == 'Large'">30_152_NoEtc_TimeZoneData.bin</_TimeZoneDataFile>

  </PropertyGroup>

  <!-- 
  Only add the data file if used in an app. UWP Native cannot handle duplicates 
  from transitive packages.
  -->
  <ItemGroup Condition="'$(_TimeZoneDataFile)' != '' and (
                        '$(OutputType)' == 'Exe' or 
                        '$(OutputType)' == 'WinExe' or 
                        '$(OutputType)' == 'AppContainerExe')">
    <Content Include="$(MSBuildThisFileDirectory)..\..\data\$(_TimeZoneDataFile)"
             Link="$(TimeZoneDataDirectory)TimeZoneData.bin"
             CopyToOutputDirectory="Always"
             SkipUnchangedFilesOnCopyAlways="true"
             Visible="false" />
  </ItemGroup>

  <PropertyGroup>
    <BuildDependsOn>
      CheckTimeZoneData;
      $(BuildDependsOn)
    </BuildDependsOn>
  </PropertyGroup>
  
  <Target Name="CheckTimeZoneData">
    <Error Text="Unknown TimeZoneData '$(TimeZoneData)'" 
             Condition="'$(TimeZoneData)' != 'Small' and '$(TimeZoneData)' != 'Medium' and '$(TimeZoneData)' != 'Large' and '$(TimeZoneData)' != 'None'" />
  </Target>
  
</Project>